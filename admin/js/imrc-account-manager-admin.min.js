(function(e){"use strict";e(function(){var a="http://"+document.domain+"/wp-content/plugins/imrc-account-manager/";var t="n";var i="u";var n=false,r,o,l=[],c={},s=[];var d,u;var m=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;var f=function(a,t,i){e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_pagination_max",table:t},success:function(t){var n=k(t),r="";for(var o=0;o<n;o++){r+='<option value="'+(o+1)+'">'+(o+1)+"</option>"}e(a+" .iam-pagination-select").html(r);e(a+" .iam-pagination-select").change(function(a){i(e(this).val())});e(".iam-select-first").click(function(t){if(e(a+" .iam-pagination-select option").eq(0).prop("selected")==true)return;var n=e(a+" .iam-pagination-select option").eq(0).prop("selected",true);i(e(a+" .iam-pagination-select").val())});e(".iam-select-prev").click(function(t){if(e(a+" .iam-pagination-select option").eq(0).prop("selected")==true)return;var n=e(a+" .iam-pagination-select option:selected");var r=n.prev("option");r.prop("selected",true);n.prop("selected",false);i(e(a+" .iam-pagination-select").val())});e(".iam-select-next").click(function(t){var n=e(a+" .iam-pagination-select option");if(e(n[n.length-1]).prop("selected")==true)return;var r=e(a+" .iam-pagination-select option:selected");var o=r.next("option");o.prop("selected",true);r.prop("selected",false);i(e(a+" .iam-pagination-select").val())});e(".iam-select-last").click(function(t){var n=e(a+" .iam-pagination-select option");if(e(n[n.length-1]).prop("selected")==true)return;e(n[n.length-1]).prop("selected",true);i(e(a+" .iam-pagination-select").val())})},error:function(e){j(e)}})};var p=function(a){e("#iam-table-container").empty();e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_charge_table_json",i:a},success:function(a){v(a,"#iam-table-container","iam-charge-table",b);e.each(e("tr"),function(a,t){if(a!=0){if(e(this).children(".iam-charge-table-approver").html()=="n/a"){e(this).append('<td><div class="iam-button iam-approve-charge-button" data-status="0">approve</div></td>')}else{e(this).append('<td><div class="iam-secondary-button iam-approve-charge-button" data-status="1">cancel</div></td>')}}});He();e(".iam-search-field").change()},error:function(e){j(e)}})};var h=function(e){p(e)};var v=function(a,t,i,n){if(typeof a=="string"){a=JSON.parse(a)}if(typeof n==="undefined"){n=function(){}}var r='<table id="'+i+'"><tbody><tr class="table-header">',o=[];for(var l=0;l<a.metadata.length;l++){var c=a.metadata[l]["editable"]?'<b style="color:red;">*</b>':"";r+="<th>"+a.metadata[l]["label"]+c+"</th>";o.push(a.metadata[l])}r+="</tr>";for(var l=0;l<a.data.length;l++){r+='<tr data-id="'+a.data[l].id+'">';for(var s=0;s<o.length;s++){var d=a.data[l].values;var u=d[o[s].name];var m=o[s].editable?"table-editable":"";switch(o[s].datatype){case"varchar":r+='<td class="'+i+"-"+o[s].name+" table-varchar "+m+'" data-field="'+o[s].name+'">'+u;break;case"text":r+='<td class="'+i+"-"+o[s].name+" table-text "+m+'" data-field="'+o[s].name+'">'+u;break}r+="</td>"}r+="</tr>"}r+="</tbody></table>";e(t).append(r);g(i,n)};var g=function(a,t){e("table#"+a+" td.table-editable").click(function(i){e(this).off();if(e(this).hasClass("table-varchar")){e(this).html('<input type="text" class="table-active-varchar table-active-data" value="'+e(this).html()+'">')}else if(e(this).hasClass("table-text")){e(this).html('<textarea class="table-active-text table-active-data">'+e(this).html()+"</textarea>")}else{alert("an error occured while editing the row! :(");return}e(".table-active-data").focus();e(".table-active-data").blur(function(i){var n=e(this).parents("td"),r=n[0],o=null;if(e(this).hasClass("table-active-varchar")){o=e(this).val();n.html(o)}else if(e(this).hasClass("table-active-text")){o=e(this).val();n.html(o)}e("table#"+a+" td.table-editable").off();g(a,t);t(r,n.parents("tr").data("id"),n.data("field"),o)})})};var b=function(a,t,i,n){P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_charge_row",id:t,field:i,val:n},success:function(e){k(e);q()},error:function(e){j(e);q()}})};var y=function(e){var a="_hiddenCopyText_";var t=e.tagName==="INPUT"||e.tagName==="TEXTAREA";var i,n;if(t){r=e;i=e.selectionStart;n=e.selectionEnd}else{r=document.getElementById(a);if(!r){var r=document.createElement("textarea");r.style.position="absolute";r.style.left="-9999px";r.style.top="0";r.id=a;document.body.appendChild(r)}r.textContent=e.textContent}var o=document.activeElement;r.focus();r.setSelectionRange(0,r.value.length);var l;try{l=document.execCommand("copy")}catch(e){l=false}if(o&&typeof o.focus==="function"){o.focus()}if(t){e.setSelectionRange(i,n)}else{r.textContent=""}return l};var w=function(a,t){var i=a.comment==""||a.comment==null?"none.":a.comment;var n=e(t);n.attr("title","Name:"+a.title+" Email:"+a.email+" Comment:"+i)};var x=function(a,t,i,n){e("body").append('<div class="iam-popup iam-submit-popup" style="width:150px;left:30%;"><div class="iam-popup-header">'+a+'<i style="float:right;" class="fa fa-close fa-3 iam-submit-popup-close"></i></div><div class="iam-popup-body">'+t+'<br/><input type="submit" class="iam-popup-submit iam-autheticate-submit"></div></div>');_();e(".iam-submit-popup input[type=submit]").click(function(a){i(n);e(".iam-popup").remove()})};var _=function(){e(".iam-submit-popup-close").click(function(a){e(".iam-popup").remove()})};var k=function(e){if(n)console.log(e);var a=JSON.parse(e);if(n)console.log(a);if(a.message!="")alert(a.status.toUpperCase()+": "+a.message);if(a.redirect!="")r=a.redirect;return a.content};var j=function(e){if(n)console.log(e);alert(e.statusText+" \n Error Code:"+e.status)};var C=function(e){e.keydown(function(e){if(e.key!="Backspace"&&e.key!="ArrowLeft"&&e.key!="ArrowRight"){if(!e.key.match(/^[0-9.]*$/)){return false}}})};var S=function(e){e.keydown(function(e){if(!e.key.match(/^[a-zA-Z0-9.@]*$/)){return false}})};var D=function(e){e.keydown(function(e){if(!e.key.match(/^[a-zA-Z0-9.]*$/)){return false}})};var E=function(e){e.keydown(function(e){if(!e.key.match(/^[a-zA-Z.]*$/)){return false}})};var T=function(e){e.keydown(function(e){if(e.key.match(/^[;'_]*$/)){return false}})};var O=function(e,a){e.keydown(function(t){if(e.val().length>=a&&t.keyCode!=8){return false}})};var Y=function(e){var a=0,t;for(t in e){if(e.hasOwnProperty(t))a++}return a};var P=function(){e("body").append('<div class="iam-loading-anim"><div class="iam-loading-bg"></div></div>')};var q=function(){e(".iam-loading-anim").remove()};var A=function(e){e.value=null;alert("Unsupported file type!\n Supported file types: .pdf, .doc, .jpg, .jpeg, .png")};var M=function(e){e.value=null;alert("One file per upload field!")};var H=function(e){if(e.files.length>1){M();return false}if(window.FileReader&&window.Blob){var a=e.files[0];var t=new FileReader;t.onloadend=function(t){var i=new Uint8Array(t.target.result).subarray(0,4);var n="";for(var r=0;r<i.length;r++){n+=i[r].toString(16)}n.toLowerCase();switch(n){case"ffd8ffdb":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":break;case"89504E47":case"89504e47":break;case"25504446":break;case"d0cf11e0":case"D0CF11E0":var o=a.name.trim().split(".");o=o[o.length-1];if(o.toLowerCase()!=="doc"){A(e)}break;default:A(e);break}};t.readAsArrayBuffer(a)}else{console.warn("FILE APIs not supported")}};var R=function(){e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_update_existing_file_list",x:e("#x").val()},success:function(a){a=k(a);e("#iam-existing-files").empty();e("#iam-existing-files").append(a)},error:function(e){j(e)}})};var N=function(e){if(e.substring(0,1)!="#")e="#"+e;return e};var L=function(a){a=N(a);var t=e(a).children();for(var i=0;i<t.length;i++){var n=t[i];if(n.tagName=="INPUT"){n.attr("value","")}else if(n.tagName=="TEXTAREA"){n.html("")}}};var G=function(a){if(e(a).attr("data-size")=="large"){e(a).attr("data-size","small");e(a).width(e(a).width()/2)}else{e(a).attr("data-size","large");e(a).width(e(a).width()*2)}};var z=function(){if(e("#iam-update-form").length<1){e("#iam-new-form").toggleClass("iam-ninja");return}if(e("#iam-new-form").hasClass("iam-ninja")){e("#iam-new-form").removeClass("iam-ninja");e("#iam-update-form").addClass("iam-ninja")}else{e("#iam-update-form").removeClass("iam-ninja");e("#iam-new-form").addClass("iam-ninja")}};var I=function(a){a=N(a);if(!e(a).hasClass("iam-ninja"))return;z()};var F=function(){e.ajax({url:ajaxurl,type:"GET",async:false,data:{action:"admin_get_tags",request:"all"},success:function(e){d=k(e);u=[];for(var a=0;a<d.length;a++){u.push(d[a].toLowerCase())}},error:function(e){j(e)}})};var W=function(e){var a="";for(var t=0;t<e;t++){a+=String.fromCharCode(97+Math.floor(Math.random()*25))}return a};var U=function(e){var a=e.indexOf("@");var t=e.lastIndexOf(".");if(a<1||t<a+2||t+2>=e.length){return false}return true};var V=function(){if(e(".iam-search").val().length>0){e(".iam-search").keyup()}};var B=function(a,t,i){e(a).keyup(function(n){e(t).each(function(t,n){if(e(this).text().toLowerCase().indexOf(e(a).val().toLowerCase())==-1){var r=e(this);for(var o=0;o<i;o++){r=r.parent()}r.addClass("iam-ninja")}else{var r=e(this);for(var o=0;o<i;o++){r=r.parent()}r.removeClass("iam-ninja")}if(e(a).val().length==0){var r=e(this);for(var o=0;o<i;o++){r=r.parent()}r.removeClass("iam-ninja")}})})};var $=function(a){e(".iam-delete-form").click(function(t){if(confirm("Are you sure you want to delete "+e("#iam-update-form #name").val()+"?")===true){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_form",x:e("#x").val(),type:a},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})}})};var Z=function(){e(".iam-existing-upload-x").click(function(a){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_supporting_file",filename:e(this).parent().text()},success:function(e){k(e);R()},error:function(e){j(e)}})})};var J=function(){e(".iam-image").click(function(e){G(this)})};var K={};var X=function(){e(".iam-account-discount").off();C(e(".iam-account-discount"));O(e(".iam-account-discount"),3);e(".iam-account-discount").change(function(a){var t=e(this).parent().parent().data("nid");if(typeof t=="undefined"||t==""){return}K[e(this).parent().parent().data("nid")]={type:e(this).parent().parent().children("td").children(".iam-account-type").val(),discount:e(this).val()}});e(".iam-account-type").change(function(a){var t=e(this).parent().parent().data("nid");if(typeof t=="undefined"||t==""){return}K[e(this).parent().parent().data("nid")]={discount:e(this).parent().parent().children("td").children(".iam-account-discount").val(),type:e(this).val()}});ae()};var Q=function(){e(".iam-push-emails-button").click(function(a){P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_push_emails"},success:function(e){k(e);q()},error:function(e){j(e)}})})};var ee=function(){e(".iam-add-account-type").click(function(a){if(e(".iam-no-data-row").length>0){e(".iam-no-data-row").remove()}e(".iam-account-type-form table tbody").append('<tr data-nid=""><td><label>Account Type</label><br /><label>Discount (0-100)</label></td>\t<td><input type="text" placeholder="example: student, faculty, alumni" class="iam-account-type"><br /><input type="number" class="iam-account-discount"></td><td><i class="iam-delete-account-type fa fa-close fa-3"></i></td></tr>');X()})};var ae=function(){e(".iam-delete-account-type").off();e(".iam-delete-account-type").click(function(a){var t=e(this).parent().parent().children("td").children(".iam-account-type").val();var i='<select class="iam-select iam-delete-account-type-select">';e(".iam-account-type").each(function(a,n){if(e(this).val()!=t){i+='<option value="'+e(this).val()+'">'+e(this).val()+"</option>"}});i+="</select>";te.bind(this);if(e(this).parent().parent().data("nid")==""){e(this).parent().parent().remove();return}x("Delete Account Type",'<p style="color:red;">Deleting: '+t+"</p><p>Select a replacement account type for users who currently have "+t+".</p>"+i,te,[e(this).parent().parent()])})};var te=function(a){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_account_type",replacement:e(".iam-delete-account-type-select").val(),nid:a[0].data("nid")},success:function(e){k(e);a[0].remove()},error:function(e){j(e)}})};var ie=function(){e(".iam-account-types-submit").click(function(a){P();var t=[];e(".iam-account-type-form table tbody tr").each(function(a,i){if(typeof e(this).data("id")=="undefined"&&e(this).children("td").children(".iam-account-type").val().length>0){var n=e(this).children("td").children(".iam-account-discount").val();n=n>0?n:0;t.push({type:e(this).children("td").children(".iam-account-type").val(),discount:n})}});e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_account_type",updated_account_types:K,new_account_types:t},success:function(e){k(e);q()},error:function(e){j(e)}})})};var ne=function(){e(".iam-settings-submit").click(function(a){P();if(!U(e(".iam-training-page-email").val())){alert("Please enter a valid email address.");return}e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_settings",ipadCode:e(".iam-ipad-code").val(),trainingEmail:e(".iam-training-page-email").val(),lateReservationsEmail:e(".iam-late-reservations-email").val(),fabLabEmail:e(".iam-fab-lab-email").val(),equipmentRoomEmail:e(".iam-equipment-room-email").val(),roomsEmail:e(".iam-rooms-email").val()},success:function(e){k(e);q()},error:function(e){j(e)}})})};var re=function(){e(".iam-admin-submit-button").off();e(".iam-admin-submit-button").click(function(a){P();var t=e(this).parent();var i=t.attr("id")=="iam-new-form"?"n":"u";var n=t.children(".iam-form-row").children("#out-of-order").is(":checked")?1:0;var r=t.children(".iam-form-row").children("#slide-show").is(":checked")?1:0;var o=t.children(".iam-form-row").children(".tags").val().trim();if(o.substring(o.length-1)==","){o=o.substring(0,o.length-1)}var l=o==""?[]:o.split(",");var c=[];for(var s=0;s<l.length;s++){l[s]=l[s].trim();if(u.indexOf(l[s].toLowerCase())==-1){c.push(l[s])}}var d=new FormData;if(t.children(".iam-form-row").children("#photo").val()!=""){d.append("photo",t.children(".iam-form-row").children("#photo").prop("files")[0])}d.append("method",i);d.append("action","admin_equipment_action");d.append("name",t.children(".iam-form-row").children("#name").val());d.append("certification",t.children(".iam-form-row").children("#certification").val());d.append("description",t.children(".iam-form-row").children("#description").val());d.append("pricing-description",t.children(".iam-form-row").children("#pricing-description").val());d.append("manufacturer-info",t.children(".iam-form-row").children("#manufacturer-info").val());d.append("out-of-order",n);d.append("on-slide-show",r);d.append("tags",l);d.append("new_tags",c);if(i=="u")d.append("x",t.children(".iam-form-row").children("#x").val());e.ajax({url:ajaxurl,type:"POST",data:d,cache:false,contentType:false,processData:false,success:function(e){k(e);window.location.reload()},error:function(e){j(e);q()}})})};var oe=function(){function a(e){return e.split(/,\s*/)}function t(e){return a(e).pop()}e(".tags").bind("keydown",function(a){if(a.keyCode===e.ui.keyCode.TAB&&e(this).autocomplete("instance").menu.active){a.preventDefault()}}).autocomplete({minLength:0,source:function(a,i){i(e.ui.autocomplete.filter(d,t(a.term)))},focus:function(){return false},select:function(e,t){var i=a(this.value);i.pop();i.push(t.item.value);i.push("");this.value=i.join(", ");return false}})};var le=function(){e("#iam-new-equipment-button").click(function(e){I("#iam-new-form");L("#iam-new-form")})};var ce=function(){e("#iam-duplicate-equipment-button").click(function(a){P();var t=e("#iam-update-form");var i="n";var n=t.children(".iam-form-row").children("#out-of-order").is(":checked")?1:0;var r=t.children(".iam-form-row").children("#slide-show").is(":checked")?1:0;var o=t.children(".iam-form-row").children(".tags").val().trim();if(o.substring(o.length-1)==","){o=o.substring(0,o.length-1)}var l=o==""?[]:o.split(",");var c=[];for(var s=0;s<l.length;s++){l[s]=l[s].trim();if(u.indexOf(l[s].toLowerCase())==-1){c.push(l[s])}}var d=new FormData;if(t.children(".iam-form-row").children(".iam-image").attr("src").indexOf("default_large.png")==-1){d.append("photo",t.children(".iam-form-row").children(".iam-image").attr("src"));d.append("duplicate","true")}var m=t.children(".iam-form-row").children("#name").val().trim();if(m.charAt(m.length-1)!=")"){m=m+" (1)"}else{var f="";var p;for(var s=m.length-2;s>-1;s--){if(!isNaN(m.charAt(s))){f=f+""+m.charAt(s)}else if(m.charAt(s)=="("){f=parseInt(f)+1;p=s;break}else{f=false;break}}if(f===false){m=m+" (1)"}else{m=m.substring(0,p)+"("+f+")"}}d.append("method",i);d.append("action","admin_equipment_action");d.append("name",m);d.append("certification",t.children(".iam-form-row").children("#certification").val());d.append("description",t.children(".iam-form-row").children("#description").val());d.append("pricing-description",t.children(".iam-form-row").children("#pricing-description").val());d.append("manufacturer-info",t.children(".iam-form-row").children("#manufacturer-info").val());d.append("out-of-order",n);d.append("on-slide-show",r);d.append("tags",l);d.append("new_tags",c);if(i=="u")d.append("x",t.children(".iam-form-row").children("#x").val());e.ajax({url:ajaxurl,type:"POST",data:d,cache:false,contentType:false,processData:false,success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var se=function(){e(".iam-existing-list li").click(function(a){I("#iam-update-form");if(e(this).html()==e("#iam-update-form").children(".iam-form-row").children("#name").val())return;e.ajax({url:ajaxurl,type:"GET",data:{action:"get_admin_forms",request:"u_equipment",name:e(this).html()},success:function(a){e("#iam-update-form").replaceWith(k(a));oe();re();$("e")},error:function(e){j(e)}})})};var de=function(){e("#supporting0").change(function(e){H(this)});e("#new-supporting0").change(function(e){H(this)})};var ue=function(){e("#iam-add-supporting-upload-button").click(function(a){e("#iam-new-supporting-upload").prepend('<input type="file" id="supporting'+sa+'" name="supporting'+sa+'"><br />');e("#supporting"+sa).change(function(e){H(this)});sa++});e("#iam-new-add-supporting-upload-button").click(function(a){e("#iam-brand-new-supporting-upload").prepend('<input type="file" id="new-supporting'+da+'" name="new-supporting'+da+'"><br />');e("#new-supporting"+da).change(function(e){H(this)});da++})};var me=function(){e(".iam-admin-submit-button").off();e(".iam-admin-submit-button").click(function(a){P();var t=e(this).parent();var i=t.attr("id")=="iam-new-form"?"n":"u";var n=new FormData;var r=t.children(".iam-form-row").children("#required").is(":checked")?1:0;n.append("action","admin_certification_action");n.append("method",i);n.append("name",t.children(".iam-form-row").children("#name").val());n.append("time",t.children(".iam-form-row").children("#time").val());n.append("description",t.children(".iam-form-row").children("#description").val());n.append("required",r);if(t.children(".iam-form-row").children("#photo").val()!=""){n.append("photo",t.children(".iam-form-row").children("#photo").prop("files")[0])}var o,l;if(i=="u"){o=sa;l="#supporting"}else{o=da;l="#new-supporting"}for(var c=0;c<=o;c++){if(e(l+c).length>0)n.append("supporting"+c,e(l+c)[0].files[0])}if(i=="u")n.append("x",t.children(".iam-form-row").children("#x").val());e.ajax({url:ajaxurl,type:"POST",processData:false,contentType:false,data:n,success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var fe=function(){e("#iam-new-certification-button").click(function(e){I("#iam-new-form");L("#iam-new-form")})};var pe=function(){e(".iam-existing-list li").click(function(a){I("#iam-update-form");if(e(this).html()==e("#iam-update-form").children(".iam-form-row").children("#name").val())return;e.ajax({url:ajaxurl,type:"GET",data:{action:"get_admin_forms",request:"u_certification",name:e(this).text()},success:function(a){e("#iam-update-form").replaceWith(k(a));me();ue();$("c")},error:function(e){j(e)}})})};var he=function(){e("#iam-new-room-button").click(function(e){I("#iam-new-form");L("#iam-new-form")})};var ve=function(){e(".iam-admin-submit-button").off();e(".iam-admin-submit-button").click(function(a){P();var t=e(this).parent();var i=t.attr("id")=="iam-new-form"?"n":"u";var n=t.children(".iam-form-row").children("#out-of-order").is(":checked")?1:0;var r=new FormData;if(t.children(".iam-form-row").children("#photo").val()!=""){r.append("photo",t.children(".iam-form-row").children("#photo").prop("files")[0])}r.append("method",i);r.append("action","admin_room_action");r.append("name",t.children(".iam-form-row").children("#name").val());r.append("description",t.children(".iam-form-row").children("#description").val());r.append("pricing-description",t.children(".iam-form-row").children("#pricing-description").val());r.append("out-of-order",n);if(i=="u")r.append("x",t.children(".iam-form-row").children("#x").val());e.ajax({url:ajaxurl,type:"POST",data:r,cache:false,contentType:false,processData:false,success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var ge=function(){e(".iam-existing-list li").click(function(a){I("#iam-update-form");if(e(this).html()==e("#iam-update-form").children(".iam-form-row").children("#name").val())return;e.ajax({url:ajaxurl,type:"GET",data:{action:"get_admin_forms",request:"u_room",name:e(this).html()},success:function(a){e("#iam-update-form").replaceWith(k(a));oe();ve();$("r")},error:function(e){j(e)}})})};var be=function(){e(".iam-balances-button").click(function(a){if(e("#amount").val().length<1){alert("invalid number");return}P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_balances_action",comment:e("#description").val(),username:e("#username").val(),amount:e("#amount").val()},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var ye=function(){e(".iam-add-funds-button").click(function(a){e("body").append('<div class="iam-popup"><div class="iam-popup-header"><h3>Add Funds</h3><i class="fa fa-close fa-3 iam-x"></i></div><div class="iam-popup-body">'+ua+"</div></div>");if(typeof o!="undefined"){e("select#username option").each(function(a,t){if(e(this).text()==o){e(this).prop("selected",true)}})}C(e("#amount"));be();e(".iam-x").click(function(a){e(".iam-popup").remove()})})};var we=function(){e("#iam-bal-charges-table-container table tr").each(function(a,t){if(e(this).children("td").length<5)return;if(e(this).children(".iam-charge-status").text()=="Canceled"||e(this).children(".iam-charge-status").text()=="Pending"){e(this).children("td").children(".iam-edit-charge-row").text("approve")}else{e(this).children("td").children(".iam-edit-charge-row").text("cancel")}});e(".iam-edit-charge-row").click(function(a){var t=this;var i=e(this).data("relational-id");e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_switch_charge_status",nid:e(this).data("nid")},success:function(a){var t=k(a);e(".iam-bal-user-row").each(function(a,n){if(e(this).data("relational-id")==i){e(e(this).children("td")[2]).text(t);return false}});ma=true;e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_charge_table",nid:fa},success:function(a){e("#iam-bal-charges-table-container").empty();e("#iam-bal-charges-table-container").append(k(a));we();e(".iam-edit-charge-row").data("relational-id",i)},error:function(e){j(e);ma=false}})},error:function(e){j(e)}})})};var xe=function(){e(".iam-see-existing-certifications").click(function(a){var t=this;e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_user_certifications",nid:e(this).data("nid")},success:function(a){e(t).parent("td").html(k(a))},error:function(e){j(e)}})})};var _e=function(){if(e("input:checked").length<1)return false;return true};var ke=function(){e("#iam-add-cert-button").click(function(a){P();if(e("#iam-cert-to-apply").val()=="Select a value"){alert("Please select a certification from the drop down menu.");return}if(!_e()){alert("Please select some accounts for this action");return}var t=[];e(":checked").each(function(a,i){t.push(e(this).data("user"))});e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_add_certifications_to_users",users:t,certification:e("#iam-cert-to-apply").val()},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})});e("#iam-remove-cert-button").click(function(a){P();if(e("#iam-cert-to-apply").val()=="Select a value"){alert("Please select a certification from the drop down menu.");return}if(!_e()){alert("Please select some accounts for this action");return}var t=[];e("input:checked").each(function(a,i){t.push(e(this).data("user"))});e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_remove_certifications_to_users",users:t,certification:e("#iam-cert-to-apply").val()},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var je=function(){l=[];c={};s=[]};var Ce=function(){e(".iam-reservation-tab-list").addClass("iam-ninja");e(".iam-res-search-container").addClass("iam-ninja");e(".iam-fab-lab-list").removeClass("iam-ninja");e(".iam-fab-lab-search-container").removeClass("iam-ninja");e(".iam-reservation-fab-lab-tab").addClass("iam-selected-tab");e(".iam-reservation-tab-list div").click(function(a){if(Y(c)||l.length){if(!confirm("Are you you want to change equipment? All unsaved changes will be lost."))return false}je();Ee(e(this).text());la=e(this).text();e(".iam-reservation-tab-list div").removeClass("iam-highlighted");e(this).addClass("iam-highlighted")})};var Se=function(){e(".iam-reservation-tabs span").click(function(a){if(!e(this).hasClass("iam-selected-tab")){e(".iam-reservation-tabs span").removeClass("iam-selected-tab");e(this).addClass("iam-selected-tab");if(e(this).hasClass("iam-reservation-fab-lab-tab")){e(".iam-reservation-tab-list").addClass("iam-ninja");e(".iam-res-search-container").addClass("iam-ninja");e(".iam-fab-lab-list").removeClass("iam-ninja");e(".iam-fab-lab-search-container").removeClass("iam-ninja")}else if(e(this).hasClass("iam-reservation-equipment-room-tab")){e(".iam-reservation-tab-list").addClass("iam-ninja");e(".iam-res-search-container").addClass("iam-ninja");e(".iam-equipment-room-list").removeClass("iam-ninja");e(".iam-equipment-room-search-container").removeClass("iam-ninja")}else if(e(this).hasClass("iam-reservation-rooms-tab")){e(".iam-reservation-tab-list").addClass("iam-ninja");e(".iam-res-search-container").addClass("iam-ninja");e(".iam-rooms-list").removeClass("iam-ninja");e(".iam-rooms-search-container").removeClass("iam-ninja")}}})};var De=function(){e(".iam-res-cal-submit").click(function(a){if(typeof la==="undefined")return;if(!Y(c)&&!l.length)return;if(!confirm("Are you sure you want to make these changes?"))return;P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_reservations",to_delete:l,modified:c,sendEmails:e(".iam-res-cal-send-emails").is(":checked"),reason:e(".iam-res-cal-reason").val()},success:function(e){k(e);Ee(la);je();q()},error:function(e){j(e)}})});e(".iam-res-cal-cancel").click(function(e){if(typeof la==="undefined")return;Ee(la)})};var Ee=function(a){e(".fc-event").each(function(){e(this).data("event",{title:e.trim(e(this).text()),stick:true,editable:true,color:"#4cad57",className:"iam-new-event"});e(this).draggable({zIndex:999,revert:true,revertDuration:0})});if(e(".iam-res-cal-placeholder").length){e(".iam-res-cal-placeholder").remove();if(e(".iam-load-all-reservations").is(":checked"))ca=ajaxurl+"?action=get_equipment_calendar&all=y&is=y&name="+a;else ca=ajaxurl+"?action=get_equipment_calendar&is=y&name="+a;e(".iam-res-cal").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},droppable:true,eventOverlap:false,weekends:true,height:600,forceEventDuration:true,defaultView:"month",editable:true,eventLimit:true,eventRender:function(e,a){w(e,a)},eventAfterRender:function(a,t){if(a.toDelete==1){e(t).css({"background-color":"#ef4040",border:"1px solid #ef4040"})}},eventDrop:function(e){c[e.nid]={start:e.start.format("YYYY-MM-DD HH:mm:ss"),end:e.end.format("YYYY-MM-DD HH:mm:ss")}},eventResize:function(e){c[e.nid]={start:e.start.format("YYYY-MM-DD HH:mm:ss"),end:e.end.format("YYYY-MM-DD HH:mm:ss")}},eventClick:function(a,t,i){var n=l.indexOf(a.nid);if(n!=-1){l.splice(n,1);a.toDelete=0;e(this).css({"background-color":"#3a87ad",border:"1px solid #3a87ad"})}else{l.push(a.nid);a.toDelete=1;e(this).css({"background-color":"#ef4040",border:"1px solid #ef4040"})}},events:ca})}else{e(".iam-res-cal").fullCalendar("removeEventSource",ca);if(e(".iam-load-all-reservations").is(":checked"))ca=ajaxurl+"?action=get_equipment_calendar&all=y&is=y&name="+a;else ca=ajaxurl+"?action=get_equipment_calendar&is=y&name="+a;e(".iam-res-cal").fullCalendar("addEventSource",ca)}};var Te=function(){Ae()};var Oe=function(){e(".iam-irregular-hours-update-button").off();e(".iam-irregular-hours-update-button").click(function(a){var t=e(this).siblings(".iam-cal");var i=e(this).parent().siblings(".iam-scheduling-name").children("h1").text().trim();i=i.replace(" ","_");P();var n=[];var r=e(this).siblings(".iam-cal").fullCalendar("clientEvents");for(var o=0;o<r.length;o++){var l,c;if(r[o].className.length>0){n.push({title:"closed",start:r[o].start.format("YYYY-MM-DD HH:mm:ss"),end:r[o].end.format("YYYY-MM-DD HH:mm:ss")})}}e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_irregular_hours",facility:i,events:n},success:function(e){k(e);t.fullCalendar("removeEventSource",ajaxurl+"?action=admin_get_irregular_hours&facility="+i);t.fullCalendar("removeEvents");t.fullCalendar("addEventSource",ajaxurl+"?action=admin_get_irregular_hours&facility="+i);q()},error:function(e){j(e)}})})};var Ye=function(){e(".iam-approval-room-select").change(function(a){e(".iam-approval-hours-cal").fullCalendar("removeEventSources");e(".iam-approval-hours-cal").fullCalendar("addEventSource",ajaxurl+"?action=admin_get_approval_hours&name="+e(this).val())})};var Pe=function(){var a=e(".iam-approval-hours-cal").fullCalendar("clientEvents");var t=[];for(var i=0;i<a.length;i++){var n=a[i];if(typeof n!="undefined"){if(n.toDelete!=1){var r=typeof n.dow=="undefined"?[n.start.format("e")]:n.dow;if(n.end.format("e")!=r[0]){var o={start:moment.utc("1970-2-1 00:00:00"),end:n.end,dow:[n.end.format("e")]};a.push(o);n.end=moment.utc("1970-2-1 23:59:59")}t.push({title:"closed",constraint:"businessHours",start:n.start.format("HH:mm:ss"),end:n.end.format("HH:mm:ss"),businessHoursMode:"multi",dow:r})}}}var l=e(".iam-approval-room-select").val();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_approval_hours",events:t,name:l},success:function(e){k(e);window.location.reload()},error:function(e){j(e);q()}})};var qe=function(){e("#approval-external-events .fc-event").each(function(){e(this).data("event",{title:"closed",stick:true,editable:true,color:"#4cad57",className:"iam-new-event"});e(this).draggable({zIndex:999,revert:true,revertDuration:0})});var a=e(".iam-approval-room-select").val();e(".iam-approval-hours-cal").fullCalendar({header:{left:"",center:"",right:"agendaWeek"},eventClick:function(a,t,i){if(t.shiftKey){e(this).remove();a.toDelete=1;Pe()}},droppable:true,eventOverlap:false,defaultDate:"1970-2-1",allDaySlot:false,height:500,forceEventDuration:true,defaultView:"agendaWeek",editable:false,eventLimit:true,title:"closed",events:ajaxurl+"?action=admin_get_approval_hours&name="+a});Ye()};var Ae=function(){e(".iam-irregular-hours-button").off();e(".iam-irregular-hours-button").click(function(a){Oe();var t=e(this).siblings(".iam-irregular-hours-cal");t.toggleClass("iam-ninja");e(this).siblings(".iam-irregular-hours-update-button").toggleClass("iam-ninja");e(this).siblings("#external-events").toggleClass("iam-ninja");e(this).siblings(".iam-irregular-hours-instructions").toggleClass("iam-ninja");if(t.hasClass("iam-ninja")){e(this).text("set irregular hours")}else{e(this).text("collapse irregular hours")}if(!t.hasClass("_init")){t.addClass("_init");e("#external-events .fc-event").each(function(){e(this).data("event",{title:"closed",stick:true,
editable:true,color:"#4cad57",className:"iam-new-event"});e(this).draggable({zIndex:999,revert:true,revertDuration:0})});var i=t.parent().siblings(".iam-scheduling-name").children("h1").text().trim();i=i.replace(" ","_");t.fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},eventClick:function(a,n,r){if(n.shiftKey){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_irregular_hours",nid:a.nid},success:function(e){k(e);var a=t;a.fullCalendar("removeEventSource",ajaxurl+"?action=admin_get_irregular_hours&facility="+i);a.fullCalendar("removeEvents");a.fullCalendar("addEventSource",ajaxurl+"?action=admin_get_irregular_hours&facility="+i);q()},error:function(e){j(e)}})}},droppable:true,eventOverlap:false,height:500,forceEventDuration:true,defaultView:"agendaWeek",editable:false,eventLimit:true,title:"closed",events:ajaxurl+"?action=admin_get_irregular_hours&facility="+i})}})};var Me=function(){e(".iam-scheduling-block input[type=submit]").off();e(".iam-scheduling-block input[type=submit]").click(function(a){var t=e(this).parent(".iam-scheduling-block");var i={};var n=true;var r=t.children(".iam-scheduling-type").children("select").val();if(r=="Rental"){i.rental_period=t.children(".iam-scheduling-info").children("label").children(".iam-rental-period").val();i.rental_hours_description=t.children(".iam-scheduling-info").children(".iam-rental-hours-description").val()}else if(r=="Appointment"){var o=["sun","mon","tue","wed","thu","fri","sat"];var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var c={};t.children(".iam-scheduling-info").children("table").children("tbody").children(".iam-opening-row").children("td").each(function(a,t){if(a!=0){if(e(this).children("label").children(".iam-closed-checkbox").is(":checked")){c[o[a-1]]={start:"",end:""}}else{var i=e(this).children(".iam-open-hour").val()+":"+e(this).children(".iam-open-min").val()+":"+e(this).children(".iam-open-am-pm").val();c[o[a-1]]={start:i}}}});t.children(".iam-scheduling-info").children("table").children("tbody").children(".iam-closing-row").children("td").each(function(a,t){if(a!=0){if(c[o[a-1]].start!=""){var i=e(this).children(".iam-close-hour").val()+":"+e(this).children(".iam-close-min").val()+":"+e(this).children(".iam-close-am-pm").val();if(moment("2016-1-1 "+c[o[a-1]].start).isAfter("2016-1-1 "+i)){alert("Your opening time for "+l[a-1]+" is after this closing time, please correct this.");n=false}c[o[a-1]].end=i}}});i.businessHours=c}else if(r=="Approval"){Pe();return}else{if(!confirm("This will disable reservations for this facility. Do you want to continue?")){return}else{e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_facility_schedule",type:t.children(".iam-scheduling-type").children("select").val(),tag:t.children(".iam-scheduling-name").text()},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})}return}if(!n){return}P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_facility_schedule",type:t.children(".iam-scheduling-type").children("select").val(),info:i,tag:t.children(".iam-scheduling-name").text()},success:function(e){k(e);window.location.reload();q()},error:function(e){j(e)}})})};var He=function(){e(".iam-approve-charge-button").off();e(".iam-approve-charge-button").click(function(a){var t=this;P();e.ajax({url:ajaxurl,type:"POST",data:{action:"approve_charge",nid:e(this).parents("tr").data("id"),status:e(this).data("status")},success:function(a){k(a);if(e(t).data("status")==1){e(t).removeClass("iam-secondary-button");e(t).addClass("iam-button");e(t).data("status",0);e(t).html("approve")}else{e(t).removeClass("iam-button");e(t).addClass("iam-secondary-button");e(t).data("status",1);e(t).html("cancel")}e(".iam-pagination-select").change();q()},error:function(e){q();j(e)}})})};var Re=function(a,t){e(".iam-csv-button").click(function(i){var n="data:text/csv;charset=utf-8,";t=typeof t==="undefined"?"":"#"+t+" ";e(t+"th").each(function(a,t){n+=e(this).text().replace(/(<([^>]+)>)/gi,"")+","});n=n.substring(0,n.length-1)+"\n";e(t+"tr").each(function(t,i){e(this).children("td").each(function(t,i){if(t!=a)n+=e(this).text().replace(/(<([^>]+)>)/gi,"")+","});n=n.substring(0,n.length-1)+"\n"});var r=encodeURI(n);window.open(r)})};var Ne=function(){e(".iam-reg-key-button").click(function(a){var t=e(".iam-reg-key-day").val();var i=e(".iam-reg-key-month").val();var n=e(".iam-reg-key-year").val();var r;if(t.length!=0||i.length!=0||n.length!=0){if(t.length<1||i.length<1||n.length<4){alert("please fill out all date fields");return}var o=moment(e(".iam-reg-key-month").val()+"-"+e(".iam-reg-key-day").val()+"-"+e(".iam-reg-key-year").val(),"M-D-YYYY");if(!o.isValid()){alert("Please enter a valid date.");return}else{r=o.format("M-D-YYYY")}}P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_make_registration_key",key:e(".iam-reg-key").val(),expiration:r},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var Le=function(){e(".iam-delete-key").click(function(a){P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_registration_key",nid:e(this).data("nid")},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})})};var Ge=function(){e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_new_mat_row"},success:function(a){e(".iam-new-mat-button").click(function(t){e("tbody").append(k(a));Ie();Ue();We()})},error:function(e){j(e)}})};var ze=function(){e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_pricing_dropdowns"},success:function(e){e=k(e);ga=e["equip"];ba=e["tags"];Ie()},error:function(e){j(e)}})};var Ie=function(){if(ga==null||ba==null){ze();return}e(".iam-add-pricing-tags-drop-down-button").off();e(".iam-add-pricing-equipment-drop-down-button").off();e(".iam-add-pricing-tags-drop-down-button").click(function(a){va.push(e(this).parent().parent().data("nid"));e(this).parent().prepend(ba);Ue()});e(".iam-add-pricing-equipment-drop-down-button").click(function(a){va.push(e(this).parent().parent().data("nid"));e(this).parent().prepend(ga);Ue()})};var Fe=function(){e("input[type=text]").off();e("input[type=number]").off();e(".iam-pricing-drop-down select").change(function(a){var t=e(this).parent().parent().parent().data("nid");if(va.indexOf(t)!=-1)return;va.push(t)});e("input[type=text]").change(function(a){var t=e(this).parent().parent().data("nid");if(va.indexOf(t)!=-1)return;va.push(t)});e("input[type=number]").change(function(a){var t=e(this).parent().parent().parent().data("nid");if(va.indexOf(t)!=-1)return;va.push(t)})};var We=function(){e(".iam-pricing-row-delete-button").off();e(".iam-pricing-row-delete-button").click(function(a){if(!confirm("Delete this row?"))return;var t=e(this).parent().parent();P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_delete_material",nid:t.data("nid")},success:function(e){k(e);t.remove();q()},error:function(e){j(e)}})})};var Ue=function(){e(".iam-delete-pricing-drop-down").off();e(".iam-delete-pricing-drop-down").click(function(a){va.push(e(this).parent().parent().parent().data("nid"));e(this).parent().remove()})};var Ve=function(){e(".iam-admin-submit-button").off();e(".iam-admin-submit-button").click(function(a){var t=[];e("tr").each(function(a,i){if(a==0)return;if(va.indexOf(e(this).data("nid"))!=-1||e(this).data("nid").length==0){var n=[];var r=[];e(e(this).children(".iam-mat-tags-data")).children(".iam-pricing-drop-down").each(function(a,t){n.push(e(this).children("select").children("option:selected").val())});e(e(this).children(".iam-mat-equip-data")).children(".iam-pricing-drop-down").each(function(a,t){r.push(e(this).children("select").children("option:selected").val())});var o=e(this).children("td").children(".iam-mat-name").val();var l=e(this).children("td").find(".iam-mat-pricing").val();var c=e(this).children("td").find(".iam-mat-base-price").val();var s=e(this).children("td").children(".iam-unit-name").val();if(o.length<1||l.length<1||s.length<1){alert("Please fill out Material Name, Price Per Unit, and Unit Name for each entry.");return}t.push({nid:e(this).data("nid"),mat_name:o,mat_pricing:l,mat_base_price:c,unit_name:s,tags:n,equipment:r})}});if(t.length<1){alert("No changes or new entries.");return}P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_pricing",updates:t},success:function(e){k(e);q()},error:function(e){j(e)}})})};var Be=[],$e={},Ze="";var Je=function(a){a=a.split(" ").join("_");if(e(".iam-cal-placeholder").length){e(".iam-cal-placeholder").remove();if(typeof $e[a]!="undefined"){Be.splice($e[a],1)}else{Be.push(a);$e[a]=Be.length-1}var t=Be.join("~!~");Ze=ajaxurl+"?action=get_equipment_calendar&is=y&descriptive=y&names="+t;e(".iam-cal").fullCalendar({header:{left:"prev,next today",center:"title",right:"agendaDay"},eventOverlap:true,weekends:true,height:600,allDaySlot:false,forceEventDuration:true,defaultView:"agendaDay",editable:false,eventLimit:true,eventRender:function(e,a){w(e,a)},eventAfterRender:function(a,t){if(a.toDelete==1){e(t).css({"background-color":"#ef4040",border:"1px solid #ef4040"})}},events:Ze})}else{e(".iam-cal").fullCalendar("removeEventSource",Ze);if(typeof $e[a]!="undefined"){Be.splice($e[a],1);$e[a]=undefined}else{Be.push(a);$e[a]=Be.length-1}var t=Be.join("~!~");Ze=ajaxurl+"?action=get_equipment_calendar&is=y&descriptive=y&names="+t;e(".iam-cal").fullCalendar("addEventSource",Ze)}};var Ke=[],Xe={},Qe="",ea=0;var aa=function(e,a){var t=s.indexOf(e.nid);if(t!=-1){s.splice(t,1);a.css({"background-color":"#3a87ad",border:"1px solid #3a87ad"})}else{if(l.indexOf(e.nid)!=-1){l.splice(t,1)}s.push(e.nid);if(ea==1){a.css({"background-color":"#d8cf6a",border:"1px solid #d8cf6a"})}else{a.css({"background-color":"#5abc5a",border:"1px solid #5abc5a"})}}};var ta=function(e,a){var t=l.indexOf(e.nid);if(t!=-1){l.splice(t,1);a.css({"background-color":"#3a87ad",border:"1px solid #3a87ad"})}else{if(s.indexOf(e.nid)!=-1){s.splice(t,1)}l.push(e.nid);a.css({"background-color":"#ef4040",border:"1px solid #ef4040"})}};var ia=function(a){var t=e("<div>"+a.email+"</div>");y(t[0]);e("body").append('<div class="iam-copy-notification">Email Copied to Clipboard</div>');e(".iam-copy-notification").fadeOut(3500,function(){e(".iam-copy-notification").remove()})};var na=function(a,t){if(a==""&&!e(".iam-cal-placeholder").length){e(".iam-cal").fullCalendar("removeEventSource",Qe);var i=Ke.join("~!~");Qe=ajaxurl+"?action=get_equipment_calendar&rstatus="+t+"&is=y&descriptive=y&names="+i;e(".iam-cal").fullCalendar("addEventSource",Qe);return}a=a.split(" ").join("_");if(e(".iam-cal-placeholder").length){e(".iam-cal-placeholder").remove();if(typeof Xe[a]!="undefined"){Ke.splice(Xe[a],1)}else{Ke.push(a);Xe[a]=Ke.length-1}var i=Ke.join("~!~");Qe=ajaxurl+"?action=get_equipment_calendar&rstatus="+t+"&is=y&descriptive=y&names="+i;e(".iam-cal").fullCalendar({header:{left:"prev,next today",center:"title",right:"agendaDay"},eventOverlap:true,weekends:true,height:600,allDaySlot:false,forceEventDuration:true,defaultView:"agendaDay",editable:false,eventLimit:true,eventRender:function(a,t){w(a,t);e(t).data("email",a.email);e(t).data("comment",a.email);e(t).data("nid",a.nid)},eventAfterAllRender:function(){oa()},eventDrop:function(e){c[e.nid]={start:e.start.format("YYYY-MM-DD HH:mm:ss"),end:e.end.format("YYYY-MM-DD HH:mm:ss")}},eventResize:function(e){c[e.nid]={start:e.start.format("YYYY-MM-DD HH:mm:ss"),end:e.end.format("YYYY-MM-DD HH:mm:ss")}},events:Qe})}else{e(".iam-cal").fullCalendar("removeEventSource",Qe);if(typeof Xe[a]!="undefined"){Ke.splice(Xe[a],1);Xe[a]=undefined}else{Ke.push(a);Xe[a]=Ke.length-1}var i=Ke.join("~!~");Qe=ajaxurl+"?action=get_equipment_calendar&rstatus="+t+"&is=y&descriptive=y&names="+i;e(".iam-cal").fullCalendar("addEventSource",Qe)}};var ra=function(){e(".iam-res-cal-submit").click(function(a){if(!Y(c)&&!l.length&&!s.length)return;if(!confirm("Are you sure you want to make these changes?"))return;P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_update_reservations",to_delete:l,confirmed:s,modified:c,sendEmails:e(".iam-res-cal-send-emails").is(":checked"),reason:e(".iam-res-cal-reason").val()},success:function(a){k(a);e(".iam-cal").fullCalendar("removeEventSource",Qe);e(".iam-cal").fullCalendar("addEventSource",Qe);je();q()},error:function(e){j(e)}})});e(".iam-res-cal-cancel").click(function(e){if(typeof la==="undefined")return;Ee(la)})};var oa=function(){var a=[{name:"confirm",title:"confirm button",fun:function(a){var t=e(a.trigger);var i={nid:t.data("nid")};aa(i,t)}},{name:"delete",title:"delete button",fun:function(a){var t=e(a.trigger);var i={nid:t.data("nid")};ta(i,t)}},{name:"copy email",title:"copy button",fun:function(a){var t=e(a.trigger);var i={email:t.data("email")};ia(i)}}];e(".fc-event").contextMenu(a,{triggerOn:"click",mouseClick:"right"})};if(e(".iam-main-menu-wrap").length>0){C(e(".iam-ipad-code"));Q();ne();ee();X();ie()}else if(e(".iam-room-wrap").length>0){ge();J();he();ve();$("r");B(".iam-room-search","#iam-room-list li",0);T(e("#iam-new-form #name"));T(e("#iam-update-form #name"));V();e(document).tooltip()}else if(e(".iam-reservation-wrap").length>0){var la,ca;je();Ce();Se();De();B(".iam-fab-lab-search",".iam-fab-lab-list div",0);B(".iam-equipment-room-search",".iam-equipment-room-list div",0);B(".iam-rooms-search",".iam-rooms-list div",0);e(document).tooltip()}else if(e(".iam-user-certification-wrap").length>0){ke();B(".iam-user-certifications-search","tr .iam-username",1);V()}else if(e(".iam-scheduling-wrap").length>0){Te();qe();Me()}else if(e(".iam-charge-sheet-wrap").length>0){Re(11);e(".iam-search-field").change(function(a){e(".iam-charge-sheet-search").val("");e("#iam-charges-table tr").removeClass("iam-ninja");e(".iam-charge-sheet-search").off();B(".iam-charge-sheet-search","#iam-charge-table tr "+e(this).val(),1)});p(1);f(".iam-charge-sheet-pagination","charge",h);e(document).tooltip()}else if(e(".iam-equipment-wrap").length>0){F();se();J();le();re();ce();oe();$("e");B(".iam-equipment-search","#iam-equipment-list li",0);T(e("#iam-new-form #name"));T(e("#iam-update-form #name"));V();e(document).tooltip()}else if(e(".iam-certification-wrap").length>0){var sa,da;sa=da=1;de();Z();fe();pe();me();ue();$("c");B(".iam-certification-search","#iam-certifcation-list li",0);T(e("#iam-new-form #name"));T(e("#iam-update-form #name"));V();e(document).tooltip()}else if(e(".iam-balances-wrap").length>0){var ua=e(".iam-add-funds").html(),ma=false,fa;e(".iam-add-funds").remove();e(".iam-bal-user-row").click(function(a){if(ma)return;ma=true;var t=this;o=e(this).children(".iam-bal-user-row-username").text();e(".iam-bal-user-row").removeClass("iam-selected-row");e(this).addClass("iam-selected-row");fa=e(this).data("nid");e.ajax({url:ajaxurl,type:"GET",data:{action:"admin_get_charge_table",nid:fa},success:function(a){e("#iam-bal-charges-table-container").empty();e("#iam-bal-charges-table-container").append(k(a));we();var i=W(30);e(t).data("relational-id",i);e(".iam-edit-charge-row").data("relational-id",i);Re(4,"iam-user-charges-table");ma=false},error:function(e){j(e);ma=false}})});ye();B(".iam-balances-search",".iam-bal-user-row-username",1);V()}else if(e(".iam-registration-wrap").length>0){e(".iam-approve-account").click(function(a){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_approve_new_user",user:e(this).data("user")},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})});e(".iam-deny-account").click(function(a){e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_deny_new_user",user:e(this).data("user")},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})});Ne();Le();B(".iam-registration-search","tr .iam-username",1)}else if(e(".iam-user-privileges-wrap").length>0){var pa=[];var ha=[];e("input[type=checkbox]").click(function(a){var t=e(this).parent().prev("td").text();for(var i=0;i<pa.length;i++){if(pa[i]==t){pa.splice(i,1);return}}for(var i=0;i<ha.length;i++){if(ha[i]==t){ha.splice(i,1);return}}if(e(this).is(":checked")){pa.push(t)}else{ha.push(t)}});e("input[type=submit]").click(function(a){P();e.ajax({url:ajaxurl,type:"POST",data:{action:"admin_user_privileges",approved:pa,denied:ha},success:function(e){k(e);window.location.reload()},error:function(e){j(e)}})});B(".iam-user-privileges-search","tr .iam-username",1)}else if(e(".iam-pricing-wrap").length>0){var va=[];var ga,ba;Ve();Fe();Ie();Ge();Ue();We()}else if(e(".iam-overview-wrap").length>0){B(".iam-overview-search",".iam-list-selectable span",1);e(".iam-list-selectable").click(function(a){Je(e(this).text());e(this).toggleClass("iam-highlighted");if(e(this).hasClass("iam-highlighted"))e(this).children("input").prop("checked",true);else e(this).children("input").prop("checked",false)});e(".iam-select-all-overview").click(function(a){e(this).toggleClass("iam-highlighted");if(e(this).hasClass("iam-highlighted")){e(this).children("input").prop("checked",true);var t=null;e(".iam-list-selectable:not(.iam-highlighted)").each(function(a,i){if(!e(this).hasClass("iam-ninja")){e(this).children("input").prop("checked",true);e(this).addClass("iam-highlighted");if(t==null){t=e(this).text()}else{Be.push(e(this).text());$e[e(this).text()]=Be.length-1}}});Je(t)}else{e(this).children("input").prop("checked",false);e(".iam-list-selectable.iam-highlighted").each(function(a,t){e(this).children("input").prop("checked",false);e(this).removeClass("iam-highlighted")});Be=[];$e={};e(".iam-cal").fullCalendar("removeEventSource",Ze)}e(this).toggleClass("iam-will-select");e(this).toggleClass("iam-will-deselect")});e(document).tooltip()}else if(e(".iam-room-res-wrap").length>0){je();ra();e(".iam-confirmed-tab").click(function(a){e(this).addClass("iam-selected-tab");e(".iam-pending-tab").removeClass("iam-selected-tab");ea=1;na("",1)});e(".iam-pending-tab").click(function(a){e(this).addClass("iam-selected-tab");e(".iam-confirmed-tab").removeClass("iam-selected-tab");ea=0;na("",0)});e(".iam-room-res-list-container ul li:not(.iam-select-all-room-res)").click(function(a){na(e(this).text(),ea);e(this).toggleClass("iam-highlighted");if(e(this).hasClass("iam-highlighted"))e(this).children("input").prop("checked",true);else e(this).children("input").prop("checked",false)});e(".iam-select-all-room-res").click(function(a){e(this).toggleClass("iam-highlighted");if(e(this).hasClass("iam-highlighted")){e(this).children("input").prop("checked",true);var t=null;e(".iam-room-res-list-container ul li:not(.iam-highlighted)").each(function(a,i){e(this).children("input").prop("checked",true);e(this).addClass("iam-highlighted");if(t==null){t=e(this).text()}else{Ke.push(e(this).text());Xe[e(this).text()]=Ke.length-1}});na(t)}else{e(this).children("input").prop("checked",false);e(".iam-room-res-list-container ul li.iam-highlighted").each(function(a,t){e(this).children("input").prop("checked",false);e(this).removeClass("iam-highlighted")});Ke=[];Xe={};e(".iam-cal").fullCalendar("removeEventSource",Qe)}});e(document).tooltip()}})})(jQuery);